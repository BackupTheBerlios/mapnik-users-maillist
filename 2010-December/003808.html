<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mapnik-users] Rendering legend elements
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/mapnik-users/2010-December/index.html" >
   <LINK REL="made" HREF="mailto:mapnik-users%40lists.berlios.de?Subject=Re%3A%20%5BMapnik-users%5D%20Rendering%20legend%20elements&In-Reply-To=%3C4CFD6407.2040301%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003807.html">
   <LINK REL="Next"  HREF="003809.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mapnik-users] Rendering legend elements</H1>
    <B>yvecai</B> 
    <A HREF="mailto:mapnik-users%40lists.berlios.de?Subject=Re%3A%20%5BMapnik-users%5D%20Rendering%20legend%20elements&In-Reply-To=%3C4CFD6407.2040301%40gmail.com%3E"
       TITLE="[Mapnik-users] Rendering legend elements">yvecai at gmail.com
       </A><BR>
    <I>Mon Dec  6 23:30:31 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="003807.html">[Mapnik-users] PointSymbolizer placement for polygons
</A></li>
        <LI>Next message: <A HREF="003809.html">[Mapnik-users] Rendering legend elements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3808">[ date ]</a>
              <a href="thread.html#3808">[ thread ]</a>
              <a href="subject.html#3808">[ subject ]</a>
              <a href="author.html#3808">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>At last, I come up with something that seems ok: A simple way for users 
to make a complete legend out of a mapnik xml map file.
It's here:
     <A HREF="https://github.com/yvecai/RenderLegend">https://github.com/yvecai/RenderLegend</A>
And the result can be seen here:
     <A HREF="http://dev-yves.dyndns.org/legend/page.html">http://dev-yves.dyndns.org/legend/page.html</A>
I tested the script on several map files found here and there, feel free 
to test it with yours.

Deeper work can be done in parsing the database queries in the postgis 
datasource, but everything works on the slippy map except turning 
circles  and spur-siding-yards (select ... as statements).

Concerning mapnik, I stumbled on the PolygonSymbolizer issue with osm 
datasource (<A HREF="http://trac.mapnik.org/ticket/673">http://trac.mapnik.org/ticket/673</A>). As a workaround I don't 
allow polygons to be rendered with rules that do not contain a 
polygonSymbolizer by adding a filter. If you want a node in the middle 
of the polygon, say so.

The next issue I have is for managing external entities in the xml: this 
would be really easy to serialize the style sheet with 
mapnik.load_map(), but this does not work if the database parameter or 
shapefiles in the original stylesheet are not correctly set 
(<A HREF="http://trac.mapnik.org/ticket/153">http://trac.mapnik.org/ticket/153</A>). And setting them is not as user 
friendly as I wanted.
Maybe  mapnik.load_map() could use an extra parameter that would avoid 
datasource validation ?

Comments welcome!

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003807.html">[Mapnik-users] PointSymbolizer placement for polygons
</A></li>
	<LI>Next message: <A HREF="003809.html">[Mapnik-users] Rendering legend elements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3808">[ date ]</a>
              <a href="thread.html#3808">[ thread ]</a>
              <a href="subject.html#3808">[ subject ]</a>
              <a href="author.html#3808">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/mapnik-users">More information about the Mapnik-users
mailing list</a><br>
</body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mapnik-users] mapnik.Image and QImage(pyqt4)
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/mapnik-users/2010-July/index.html" >
   <LINK REL="made" HREF="mailto:mapnik-users%40lists.berlios.de?Subject=Re%3A%20%5BMapnik-users%5D%20mapnik.Image%20and%20QImage%28pyqt4%29&In-Reply-To=%3C1279394557.11280.398.camel%40localhost.localdomain%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003394.html">
   <LINK REL="Next"  HREF="003396.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mapnik-users] mapnik.Image and QImage(pyqt4)</H1>
    <B>Jon Burgess</B> 
    <A HREF="mailto:mapnik-users%40lists.berlios.de?Subject=Re%3A%20%5BMapnik-users%5D%20mapnik.Image%20and%20QImage%28pyqt4%29&In-Reply-To=%3C1279394557.11280.398.camel%40localhost.localdomain%3E"
       TITLE="[Mapnik-users] mapnik.Image and QImage(pyqt4)">jburgess777 at gmail.com
       </A><BR>
    <I>Sat Jul 17 21:22:37 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="003394.html">[Mapnik-users] mapnik.Image and QImage(pyqt4)
</A></li>
        <LI>Next message: <A HREF="003396.html">[Mapnik-users] mapnik.Image and QImage(pyqt4)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3395">[ date ]</a>
              <a href="thread.html#3395">[ thread ]</a>
              <a href="subject.html#3395">[ subject ]</a>
              <a href="author.html#3395">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, 2010-07-17 at 12:35 +0800, feverzsj wrote:
&gt;<i> hi, list:
</I>&gt;<i> some python code:
</I>&gt;<i>   im = mapnik.Image(self.map.width, self.map.height)
</I>&gt;<i>   mapnik.render(self.map, im)
</I>&gt;<i>   qim = QImage()
</I>&gt;<i>   qim.loadFromData(QByteArray(im.tostring('png')))
</I>&gt;<i> 
</I>&gt;<i>   The questions are: why we should pass a string 'png'? What is stored 
</I>&gt;<i> in mapnik.Image? What is done in the tostring()?
</I>
The mapnik.Image is a wrapper around the raw bitmap data of the rendered
image. The tosting('png') asks mapnik to convert this into a PNG image
and return it as a python string. This is then converted into a QT byte
array and then finally converted into a QImage. 

A PNG image was probably chosen as a simple standard format which Mapnik
can create and QT can read. This method is fairly simple and reliable
but not the most efficient. 

It may be possible to directly convert the raw bitmap data from Mapnik
into a QImage but it would need some careful reading of the docs to
figure out if they are compatible. This approach is taken by the C++
Mapnik viewer application:
<A HREF="http://trac.mapnik.org/browser/trunk/demo/viewer/mapwidget.cpp#L460">http://trac.mapnik.org/browser/trunk/demo/viewer/mapwidget.cpp#L460</A>

   Jon



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003394.html">[Mapnik-users] mapnik.Image and QImage(pyqt4)
</A></li>
	<LI>Next message: <A HREF="003396.html">[Mapnik-users] mapnik.Image and QImage(pyqt4)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3395">[ date ]</a>
              <a href="thread.html#3395">[ thread ]</a>
              <a href="subject.html#3395">[ subject ]</a>
              <a href="author.html#3395">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/mapnik-users">More information about the Mapnik-users
mailing list</a><br>
</body></html>

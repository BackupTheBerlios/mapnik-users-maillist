<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Mapnik-users] Projection Issue between datafile and XML/Python	files
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/mapnik-users/2011-June/index.html" >
   <LINK REL="made" HREF="mailto:mapnik-users%40lists.berlios.de?Subject=Re%3A%20%5BMapnik-users%5D%20Projection%20Issue%20between%20datafile%20and%20XML/Python%0A%09files&In-Reply-To=%3CC3EB6E30-3490-42BA-8B0D-591D7507440B%40dbsgeo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004352.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Mapnik-users] Projection Issue between datafile and XML/Python	files</H1>
    <B>Dane Springmeyer</B> 
    <A HREF="mailto:mapnik-users%40lists.berlios.de?Subject=Re%3A%20%5BMapnik-users%5D%20Projection%20Issue%20between%20datafile%20and%20XML/Python%0A%09files&In-Reply-To=%3CC3EB6E30-3490-42BA-8B0D-591D7507440B%40dbsgeo.com%3E"
       TITLE="[Mapnik-users] Projection Issue between datafile and XML/Python	files">dane at dbsgeo.com
       </A><BR>
    <I>Mon Jun 27 19:38:09 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="004352.html">[Mapnik-users] Projection Issue between datafile and XML/Python	files
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4355">[ date ]</a>
              <a href="thread.html#4355">[ thread ]</a>
              <a href="subject.html#4355">[ subject ]</a>
              <a href="author.html#4355">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ben,

It would be helpful if you could paste your whole XML or python script. That way I could see issues more clearly like: are you remembering to set the layer 'srs' value? When loaded via XML a layer without an 'srs' value set will default to the map 'srs'. But in python a layer created from scratch (since it is not part of any map yet) will default to EPSG:4326 (+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs).

Also, spherical mercator, or the google projection you want is likely:

+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over

The +nadgrids=@null is the key part you are missing.

Dane

On Jun 27, 2011, at 3:49 AM, Ben Crane wrote:

&gt;<i> Hi all,
</I>&gt;<i> 
</I>&gt;<i> I've installed and got mapnik working for shape, tab and postgis and am making good progress...but I have a question regarding projections :
</I>&gt;<i> 
</I>&gt;<i> My shape file is in WGS84. I reference a particulare area of the world file in standard lat/long notation in the python script eg:
</I>&gt;<i> 
</I>&gt;<i> bbox = mapnik.Envelope(mapnik.Coord(-180.0, -75.0), mapnik.Coord(180.0, 90.0))
</I>&gt;<i> 
</I>&gt;<i> What I was wondering is that if I change the projection of the python script/XML styles to EPSG: 3857 (Popular Visualizations) and the shape file remains in WGS84 is that going to cause a conflict in terms of which projection is used? The reason I ask is that I altered the projection to: 
</I>&gt;<i> srs=&quot;+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378137 +b=6378137 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs&quot;
</I>&gt;<i> 
</I>&gt;<i> and then altered the Envelope clause to bbox = mapnik.Envelope(mapnik.Coord(-2022737, 476045), mapnik.Coord(3223267, 5458042)) (focussing on Spain) but no joy - I get a white png image and no errors which makes be think it's just taken a snapshot of nothing since lat/long isn't in this range.
</I>&gt;<i> 
</I>&gt;<i> So either I cannot override the shape file projection, or I am doing it incorrectly...is this possible
</I>&gt;<i> 
</I>&gt;<i> Many thanx,
</I>&gt;<i> 
</I>&gt;<i> BC
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mapnik-users mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/mapnik-users">Mapnik-users at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/mapnik-users">https://lists.berlios.de/mailman/listinfo/mapnik-users</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/mapnik-users/attachments/20110627/7ebf64f8/attachment.html">https://lists.berlios.de/pipermail/mapnik-users/attachments/20110627/7ebf64f8/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004352.html">[Mapnik-users] Projection Issue between datafile and XML/Python	files
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4355">[ date ]</a>
              <a href="thread.html#4355">[ thread ]</a>
              <a href="subject.html#4355">[ subject ]</a>
              <a href="author.html#4355">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/mapnik-users">More information about the Mapnik-users
mailing list</a><br>
</body></html>
